<UserControl x:Class="DevToolVault.Controls.FileSystemTreeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:models="clr-namespace:DevToolVault.Core.Models"
             xmlns:conv="clr-namespace:DevToolVault.Converters"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">

    <UserControl.Resources>
        <conv:IconConverter x:Key="IconConverter"/>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Barra de ferramentas -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
            <CheckBox x:Name="chkSelectAll"
                      Content="Selecionar tudo"
                      Margin="0,0,10,0"
                      Checked="ChkSelectAll_Checked"
                      Unchecked="ChkSelectAll_Unchecked"
                      IsThreeState="True"/>
            <Button x:Name="btnExpandAll" Content="Expandir tudo" Margin="0,0,5,0" Click="BtnExpandAll_Click"/>
            <Button x:Name="btnCollapseAll" Content="Recolher tudo" Margin="0,0,5,0" Click="BtnCollapseAll_Click"/>
            <Button x:Name="btnRefresh" Content="Atualizar" Margin="0,0,5,0" Click="BtnRefresh_Click"/>
        </StackPanel>

        <!-- TreeView -->
        <TreeView x:Name="treeFiles" Grid.Row="1">
            <TreeView.ItemContainerStyle>
                <Style TargetType="{x:Type TreeViewItem}">
                    <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                </Style>
            </TreeView.ItemContainerStyle>

            <TreeView.Resources>
                <HierarchicalDataTemplate DataType="{x:Type models:FileSystemItem}" ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal">
                        <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  IsThreeState="{Binding IsDirectory}"
                                  Checked="CheckBox_Checked"
                                  Unchecked="CheckBox_Unchecked"
                                  Indeterminate="CheckBox_Indeterminate"
                                  Margin="0,0,5,0"/>
                        <TextBlock Text="{Binding Name}"/>
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.Resources>
        </TreeView>
    </Grid>
</UserControl>
